{"workbook":{"config":{},"id":"40b287e0-0de4-11ed-83eb-e9e7cd859878","name":"MULTIPLE_TSM_DC","description":"MULTIPLE_TSM_DC","user_id":"c3e3cb20-0dde-11ed-83eb-e9e7cd859878","warehouse_id":null,"is_example":false,"is_shared":false,"created_at":"2022-07-27T19:42:30.750Z","updated_at":"2022-07-27T19:42:30.750Z","userId":"c3e3cb20-0dde-11ed-83eb-e9e7cd859878"},"worksheets":[{"config":{},"id":"40b82d30-0de4-11ed-83eb-e9e7cd859878","name":"Sheet 1","description":"Description for Sheet 1","previous_worksheet_id":null,"next_worksheet_id":null,"workbook_id":"40b287e0-0de4-11ed-83eb-e9e7cd859878","created_at":"2022-07-27T19:42:30.787Z","updated_at":"2022-07-27T19:42:30.787Z","workbookId":"40b287e0-0de4-11ed-83eb-e9e7cd859878"}],"blockMap":{"40b82d30-0de4-11ed-83eb-e9e7cd859878":[{"config":{},"id":"40bd8460-0de4-11ed-83eb-e9e7cd859878","name":"Block 1","description":"Description for Block 1","content":"[{\"type\":\"paragraph\",\"children\":[{\"text\":\"This small case is the demonstration of running travelling salesmen problem in batches - using the MSDO solver - In oder to cast the problem into MSDO context, we need to assume each salesmen as a supply side with one truck each and the capacity of the truck equal to the number of deliveries. Likewise, the stop locations will be assumed to be the demand size with the demands size of eactly one in each. Steps involved:\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"1. Read Graph Road Network raw data from S3 bucket\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"2. Create Supply and Demand tables with the note above in mind s.t., the total supplies matches total demand size exactly.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"3. Run match/graph with MSDO solver.\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"4. Class Break Visualization of the salesmen routes on the output table by breaking on the salesmen id (SUPPLY ID).\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"5. Re-run match graph with animation options, i.e., svg options, by generating the tracks - option is 'output_tracks' (see below).\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"6. Flip the goal to a batch od shortest path runs; from supply location to every other stop (demand) location, create od matrix by the cross join of supply/demand tables and assign od id as the sum of the two\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"7. Run 'match_batch_solves' of /match/graph and see the result as animated svg paths.\"}]}]","previous_block_id":null,"next_block_id":"40c28d70-0de4-11ed-83eb-e9e7cd859878","block_type_id":"a9949a1a-14e3-11eb-adc1-0242ac120002","worksheet_id":"40b82d30-0de4-11ed-83eb-e9e7cd859878","created_at":"2022-07-27T19:42:30.822Z","updated_at":"2022-07-27T19:42:30.889Z","worksheetId":"40b82d30-0de4-11ed-83eb-e9e7cd859878","blockTypeId":"a9949a1a-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"40c28d70-0de4-11ed-83eb-e9e7cd859878","name":"Block 2","description":"Description for Block 2","content":"\"DROP TABLE IF EXISTS ki_home.dc;\\nCREATE OR REPLACE DATA SOURCE quickstart\\nLOCATION = 'S3'\\nWITH OPTIONS (\\n    ANONYMOUS = 'true',\\n    BUCKET NAME = 'quickstartpublic',\\n    REGION = 'us-east-1'\\n);\\nLOAD DATA INTO dc \\nFROM FILE PATHS 'dc/dc.csv'\\nFORMAT TEXT \\nWITH OPTIONS (\\n    DATA SOURCE = 'quickstart'\\n);\"","previous_block_id":"40bd8460-0de4-11ed-83eb-e9e7cd859878","next_block_id":"40d2e120-0de4-11ed-83eb-e9e7cd859878","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"40b82d30-0de4-11ed-83eb-e9e7cd859878","created_at":"2022-07-27T19:42:30.856Z","updated_at":"2022-07-27T19:42:31.011Z","worksheetId":"40b82d30-0de4-11ed-83eb-e9e7cd859878","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"40d2e120-0de4-11ed-83eb-e9e7cd859878","name":"Block 3","description":"Description for Block 3","content":"\"CREATE OR REPLACE TABLE dc_supplies (wkt WKT NOT NULL, id INT NOT NULL, size FLOAT NOT NULL, truck_id INT NOT NULL);\\nINSERT INTO dc_supplies \\nVALUES ('POINT(-77.116787 38.885892)',1,2,1), ('POINT (-77.015707 38.904309)', 2, 3, 2);\\nselect * from dc_supplies;\"","previous_block_id":"40c28d70-0de4-11ed-83eb-e9e7cd859878","next_block_id":"40e075b0-0de4-11ed-83eb-e9e7cd859878","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"40b82d30-0de4-11ed-83eb-e9e7cd859878","created_at":"2022-07-27T19:42:30.962Z","updated_at":"2022-07-27T19:42:31.121Z","worksheetId":"40b82d30-0de4-11ed-83eb-e9e7cd859878","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"40e075b0-0de4-11ed-83eb-e9e7cd859878","name":"Block 4","description":"Description for Block 4","content":"\"CREATE OR REPLACE TABLE dc_demands (wkt WKT NOT NULL, id INT NOT NULL, supply_id INT NOT NULL, size FLOAT NOT NULL);\\nINSERT INTO dc_demands \\nVALUES ('POINT (-77.088237 38.895701)', 10, 1, 1.0), ('POINT (-77.150693 38.892861)', 50, 1, 1.0), \\n       ('POINT( -76.956383 39.071894)', 20, 2, 1.0), ('POINT (-77.069505 38.91801)', 30, 2, 1.0), ('POINT (-77.063653 38.908072)', 40, 2, 1.0);\\nselect * from dc_demands;\"","previous_block_id":"40d2e120-0de4-11ed-83eb-e9e7cd859878","next_block_id":"40ef90e0-0de4-11ed-83eb-e9e7cd859878","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"40b82d30-0de4-11ed-83eb-e9e7cd859878","created_at":"2022-07-27T19:42:31.051Z","updated_at":"2022-07-27T19:42:31.183Z","worksheetId":"40b82d30-0de4-11ed-83eb-e9e7cd859878","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"40ef90e0-0de4-11ed-83eb-e9e7cd859878","name":"Block 5","description":"Description for Block 5","content":"\"select IF(total_demands>=total_supplies,'SUPLLY MATCHES DEMAND','SUPPLY LESS THAN DEMAND') as kk from \\n(select sum(size) as total_demands from dc_demands),\\n(select sum(size) as total_supplies from dc_supplies);\"","previous_block_id":"40e075b0-0de4-11ed-83eb-e9e7cd859878","next_block_id":"40feac10-0de4-11ed-83eb-e9e7cd859878","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"40b82d30-0de4-11ed-83eb-e9e7cd859878","created_at":"2022-07-27T19:42:31.150Z","updated_at":"2022-07-27T19:42:31.286Z","worksheetId":"40b82d30-0de4-11ed-83eb-e9e7cd859878","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"40feac10-0de4-11ed-83eb-e9e7cd859878","name":"Block 6","description":"Description for Block 6","content":"\"CREATE OR REPLACE DIRECTED GRAPH\\n                  dc ( EDGES => INPUT_TABLE(\\n                                           (SELECT id  AS ID,\\n                                                   wkt AS WKTLINE,\\n                                                   dir AS DIRECTION,\\n                                                   time  AS WEIGHT_VALUESPECIFIED                                                   \\n                                           FROM ki_home.dc))\\n                  );\"","previous_block_id":"40ef90e0-0de4-11ed-83eb-e9e7cd859878","next_block_id":"4109cfa0-0de4-11ed-83eb-e9e7cd859878","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"40b82d30-0de4-11ed-83eb-e9e7cd859878","created_at":"2022-07-27T19:42:31.249Z","updated_at":"2022-07-27T19:42:31.393Z","worksheetId":"40b82d30-0de4-11ed-83eb-e9e7cd859878","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"4109cfa0-0de4-11ed-83eb-e9e7cd859878","name":"Block 7","description":"Description for Block 7","content":"\"DROP TABLE IF EXISTS ki_home.dc_msdo;\\nEXECUTE FUNCTION\\nMATCH_GRAPH(\\n      GRAPH => 'ki_home.dc',\\n      SAMPLE_POINTS => INPUT_TABLES(\\n                               (SELECT id        AS DEMAND_ID,\\n                                       wkt       AS DEMAND_WKTPOINT,\\n                                       size      AS DEMAND_SIZE,\\n                                       supply_id AS DEMAND_DEPOT_ID\\n                                FROM ki_home.dc_demands\\n                               ),\\n                               (SELECT id       AS SUPPLY_DEPOT_ID,\\n                                       wkt      AS SUPPLY_WKTPOINT,\\n                                       truck_id AS SUPPLY_TRUCK_ID,\\n                                       size     AS SUPPLY_TRUCK_SIZE\\n                                FROM ki_home.dc_supplies\\n                               )\\n      ),\\n      SOLVE_METHOD   => 'match_supply_demand',\\n      SOLUTION_TABLE => 'ki_home.dc_msdo',\\n      OPTIONS => KV_PAIRS( output_tracks = 'false',\\n                           aggregated_output   = 'true'));\"","previous_block_id":"40feac10-0de4-11ed-83eb-e9e7cd859878","next_block_id":"4119ae20-0de4-11ed-83eb-e9e7cd859878","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"40b82d30-0de4-11ed-83eb-e9e7cd859878","created_at":"2022-07-27T19:42:31.322Z","updated_at":"2022-07-27T19:42:31.483Z","worksheetId":"40b82d30-0de4-11ed-83eb-e9e7cd859878","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"4119ae20-0de4-11ed-83eb-e9e7cd859878","name":"Block 8","description":"Description for Block 8","content":"\"select * from ki_home.dc_msdo;\"","previous_block_id":"4109cfa0-0de4-11ed-83eb-e9e7cd859878","next_block_id":"412c72d0-0de4-11ed-83eb-e9e7cd859878","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"40b82d30-0de4-11ed-83eb-e9e7cd859878","created_at":"2022-07-27T19:42:31.426Z","updated_at":"2022-07-27T19:42:31.587Z","worksheetId":"40b82d30-0de4-11ed-83eb-e9e7cd859878","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"412c72d0-0de4-11ed-83eb-e9e7cd859878","name":"Block 9","description":"Description for Block 9","content":"\"DROP TABLE IF EXISTS ki_home.dc_msdo_svg;\\nEXECUTE FUNCTION\\nMATCH_GRAPH(\\n      GRAPH => 'ki_home.dc',\\n      SAMPLE_POINTS => INPUT_TABLES(\\n                               (SELECT id        AS DEMAND_ID,\\n                                       wkt       AS DEMAND_WKTPOINT,\\n                                       size      AS DEMAND_SIZE,\\n                                       supply_id AS DEMAND_DEPOT_ID\\n                                FROM ki_home.dc_demands\\n                               ),\\n                               (SELECT id       AS SUPPLY_DEPOT_ID,\\n                                       wkt      AS SUPPLY_WKTPOINT,\\n                                       truck_id AS SUPPLY_TRUCK_ID,\\n                                       size     AS SUPPLY_TRUCK_SIZE\\n                                FROM ki_home.dc_supplies\\n                               )\\n      ),\\n      SOLVE_METHOD   => 'match_supply_demand',\\n      SOLUTION_TABLE => 'ki_home.dc_msdo_svg',\\n      OPTIONS => KV_PAIRS( output_tracks = 'true',\\n                           aggregated_output   = 'true',\\n                           svg_width = '400', svg_height = '600',  svg_speed = '100', svg_basemap = 'true', timeout = '60'));\"","previous_block_id":"4119ae20-0de4-11ed-83eb-e9e7cd859878","next_block_id":"41380b90-0de4-11ed-83eb-e9e7cd859878","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"40b82d30-0de4-11ed-83eb-e9e7cd859878","created_at":"2022-07-27T19:42:31.549Z","updated_at":"2022-07-27T19:42:31.737Z","worksheetId":"40b82d30-0de4-11ed-83eb-e9e7cd859878","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"41380b90-0de4-11ed-83eb-e9e7cd859878","name":"Block 10","description":"Description for Block 10","content":"\"create or replace view dc_od_pairs as \\nselect dc_supplies.wkt as origin,  dc_demands.wkt as target, dc_supplies.id+dc_demands.id as id \\nfrom dc_supplies cross join dc_demands;\\nselect * from dc_od_pairs;\"","previous_block_id":"412c72d0-0de4-11ed-83eb-e9e7cd859878","next_block_id":"414f1600-0de4-11ed-83eb-e9e7cd859878","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"40b82d30-0de4-11ed-83eb-e9e7cd859878","created_at":"2022-07-27T19:42:31.626Z","updated_at":"2022-07-27T19:42:31.811Z","worksheetId":"40b82d30-0de4-11ed-83eb-e9e7cd859878","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"414f1600-0de4-11ed-83eb-e9e7cd859878","name":"Block 11","description":"Description for Block 11","content":"\"DROP TABLE IF EXISTS ki_home.dc_sssp;\\nEXECUTE FUNCTION\\nMATCH_GRAPH(\\n    GRAPH => 'ki_home.dc',\\n    SOLVE_METHOD => 'match_batch_solves',\\n    SAMPLE_POINTS => INPUT_TABLE ( SELECT \\n                            origin AS SAMPLE_ORIGIN_WKTPOINT,\\n                            target AS SAMPLE_DESTINATION_WKTPOINT,\\n                            id     AS SAMPLE_OD_ID FROM ki_home.dc_od_pairs),\\n    SOLUTION_TABLE => 'ki_home.dc_sssp',\\n    OPTIONS => KV_PAIRS(output_tracks = 'true',\\n                           aggregated_output   = 'true',\\n                           svg_width = '400', svg_height = '600',  svg_speed = '20', svg_basemap = 'true', timeout = '60')\\n);\"","previous_block_id":"41380b90-0de4-11ed-83eb-e9e7cd859878","next_block_id":null,"block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"40b82d30-0de4-11ed-83eb-e9e7cd859878","created_at":"2022-07-27T19:42:31.776Z","updated_at":"2022-07-27T19:42:31.776Z","worksheetId":"40b82d30-0de4-11ed-83eb-e9e7cd859878","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"}]},"vizMap":{"40bd8460-0de4-11ed-83eb-e9e7cd859878":[],"40c28d70-0de4-11ed-83eb-e9e7cd859878":[],"40d2e120-0de4-11ed-83eb-e9e7cd859878":[],"40e075b0-0de4-11ed-83eb-e9e7cd859878":[],"40ef90e0-0de4-11ed-83eb-e9e7cd859878":[],"40feac10-0de4-11ed-83eb-e9e7cd859878":[],"4109cfa0-0de4-11ed-83eb-e9e7cd859878":[],"4119ae20-0de4-11ed-83eb-e9e7cd859878":[],"412c72d0-0de4-11ed-83eb-e9e7cd859878":[],"41380b90-0de4-11ed-83eb-e9e7cd859878":[],"414f1600-0de4-11ed-83eb-e9e7cd859878":[]}}