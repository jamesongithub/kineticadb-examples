{"workbook":{"config":{},"id":"bd4a8060-a010-11ec-a817-7f4608b5e3ed","name":"Real-time Benchmark Citi Bike - Station Demand","description":"Citi Bike - Station Demand demo","user_id":"819f4300-a00d-11ec-a817-7f4608b5e3ed","warehouse_id":"6c5c74e0-5896-11ec-a671-636d46891057","is_example":false,"is_shared":false,"created_at":"2021-10-19T14:21:53.337Z","updated_at":"2022-03-10T01:23:49.735Z","userId":"819f4300-a00d-11ec-a817-7f4608b5e3ed"},"worksheets":[{"config":{},"id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","name":"Data Source and Sinks","description":"Description for Sheet 1","previous_worksheet_id":"bd95e140-a010-11ec-a817-7f4608b5e3ed","next_worksheet_id":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","workbook_id":"bd4a8060-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-19T14:21:53.439Z","updated_at":"2022-03-18T13:27:31.511Z","workbookId":"bd4a8060-a010-11ec-a817-7f4608b5e3ed"},{"config":{},"id":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","name":"Regression Calc Views","description":"Description for sheet 2","previous_worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","next_worksheet_id":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","workbook_id":"bd4a8060-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-19T14:54:52.867Z","updated_at":"2022-03-18T13:27:31.521Z","workbookId":"bd4a8060-a010-11ec-a817-7f4608b5e3ed"},{"config":{},"id":"bd95e140-a010-11ec-a817-7f4608b5e3ed","name":"Table Definition","description":"Description for sheet 3","previous_worksheet_id":null,"next_worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","workbook_id":"bd4a8060-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-19T15:42:31.957Z","updated_at":"2022-03-10T01:23:50.707Z","workbookId":"bd4a8060-a010-11ec-a817-7f4608b5e3ed"},{"config":{},"id":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","name":"Real-time Decisioning and Alert","description":"Description for sheet 4","previous_worksheet_id":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","next_worksheet_id":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","workbook_id":"bd4a8060-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-19T15:49:27.044Z","updated_at":"2022-03-10T01:23:50.720Z","workbookId":"bd4a8060-a010-11ec-a817-7f4608b5e3ed"},{"config":{},"id":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","name":"Future changes in works","description":"Description for sheet 6","previous_worksheet_id":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","next_worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","workbook_id":"bd4a8060-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T19:49:57.937Z","updated_at":"2022-03-10T01:23:50.736Z","workbookId":"bd4a8060-a010-11ec-a817-7f4608b5e3ed"},{"config":{},"id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","name":"Sheet 7","description":"Description for sheet 7","previous_worksheet_id":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","next_worksheet_id":null,"workbook_id":"bd4a8060-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-09T21:02:24.181Z","updated_at":"2022-03-18T03:30:57.090Z","workbookId":"bd4a8060-a010-11ec-a817-7f4608b5e3ed"}],"blockMap":{"bd4c5520-a010-11ec-a817-7f4608b5e3ed":[{"config":{},"id":"bd4ddbc0-a010-11ec-a817-7f4608b5e3ed","name":"Block 1","description":"Description for Block 1","content":"\"create or replace credential bike_cred\\ntype = 'kafka',\\nidentity = 'user' ,\\nSECRET = 'secret'\\nwith options (\\n   'security.protocol' = 'SASL_SSL',\\n   'sasl.mechanism' = 'PLAIN',\\n   'sasl.username'='IHSY3GI7UBM3SZH5',\\n   'sasl.password'='9QPFJyYtrfW7Fnbl95/TPmBs+A3yFpkedZxPT9P+AiadHpa9YTbHmjcbpxQNdMP+'\\n)\"","previous_block_id":"bd5a85f0-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bd586310-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-19T14:21:53.531Z","updated_at":"2022-03-10T01:23:49.899Z","worksheetId":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd4f8970-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"CREATE OR REPLACE DATA SOURCE bk\\n    LOCATION = 'kafka://pkc-ep9mm.us-east-2.aws.confluent.cloud:9092'\\n    WITH OPTIONS (\\n   'kafka_topic_name' = 'nyc-citibike-station-status',   \\n   CREDENTIAL = 'bike_cred')\"","previous_block_id":"bd586310-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bd5c33a0-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-19T14:25:21.447Z","updated_at":"2022-03-10T01:23:49.908Z","worksheetId":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd524890-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"LOAD DATA INTO station_status\\nFROM FILE PATHS '' FORMAT JSON\\nWITH OPTIONS ( \\n  DATA SOURCE = 'bk',\\n  SUBSCRIBE = 'TRUE',\\n  type_inference_mode = 'SPEED',\\n  kafka_group_id = 'CAB_10192021'\\n  )\"","previous_block_id":"bd5c33a0-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bd5d9330-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-19T14:25:35.647Z","updated_at":"2022-03-10T01:23:49.922Z","worksheetId":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd53a820-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"CREATE OR REPLACE DATA SOURCE bk_info\\n    LOCATION = 'kafka://pkc-ep9mm.us-east-2.aws.confluent.cloud:9092'\\n    WITH OPTIONS (\\n   'kafka_topic_name' = 'nyc-citibike-station-info',   \\n   CREDENTIAL = 'bike_cred')\"","previous_block_id":"bd5d9330-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bd5507b0-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-19T14:48:22.836Z","updated_at":"2022-03-10T01:23:49.932Z","worksheetId":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd5507b0-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"DROP TABLE IF EXISTS \\\"station_info\\\" ;\\n\\nLOAD DATA INTO station_info\\nFROM FILE PATHS '' FORMAT JSON\\nWITH OPTIONS ( \\n  DATA SOURCE = 'bk_info',\\n  SUBSCRIBE = 'TRUE',\\n  type_inference_mode = 'SPEED',\\n  kafka_group_id = 'CAB_10192021'\\n  )\"","previous_block_id":"bd53a820-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bd613cb0-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-19T14:48:44.758Z","updated_at":"2022-03-10T01:23:49.942Z","worksheetId":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd568e50-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"CREATE OR REPLACE DATA SINK station_alerts\\n    LOCATION = 'kafka://pkc-ep9mm.us-east-2.aws.confluent.cloud:9092'\\n    WITH OPTIONS (\\n   KAFKA_TOPIC_NAME = 'nyc-citibike-demand-alert',   \\n   CREDENTIAL = 'bike_cred')\"","previous_block_id":"bd613cb0-a010-11ec-a817-7f4608b5e3ed","next_block_id":null,"block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-19T17:28:36.870Z","updated_at":"2022-03-10T01:23:49.958Z","worksheetId":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd586310-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Create data source for the nyc-citibike-station-status topic on Confluent Kafka cluster. This topic is continously pulling data from citibike web\",\"bold\":true}]}]","previous_block_id":"bd4ddbc0-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bd4f8970-a010-11ec-a817-7f4608b5e3ed","block_type_id":"a9949a1a-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T16:01:19.926Z","updated_at":"2022-03-10T01:23:49.969Z","worksheetId":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"a9949a1a-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd5a85f0-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Create Credential to connect to Kafka cluster\",\"bold\":true}]}]","previous_block_id":"bd5f19d0-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bd4ddbc0-a010-11ec-a817-7f4608b5e3ed","block_type_id":"a9949a1a-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T16:01:22.195Z","updated_at":"2022-03-10T01:23:49.978Z","worksheetId":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"a9949a1a-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd5c33a0-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Start ingesting streaming data from the data source for Kafka topic nyc-citibike-station-status  into station_status table\",\"bold\":true}]}]","previous_block_id":"bd4f8970-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bd524890-a010-11ec-a817-7f4608b5e3ed","block_type_id":"a9949a1a-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T16:02:42.780Z","updated_at":"2022-03-10T01:23:49.989Z","worksheetId":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"a9949a1a-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd5d9330-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Create data source for nyc-citibike-station-info topic and load data into station_info\"}]}]","previous_block_id":"bd524890-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bd53a820-a010-11ec-a817-7f4608b5e3ed","block_type_id":"a9949a1a-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T16:03:53.218Z","updated_at":"2022-03-10T01:23:50.004Z","worksheetId":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"a9949a1a-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd5f19d0-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Data Sources overview:\",\"bold\":true}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"Real-time stream of NYC Citibike station data are available through these 2 web apis: \"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"https://gbfs.citibikenyc.com/gbfs/en/station_information.json  \"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\" https://gbfs.citibikenyc.com/gbfs/en/station_status.json \"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"A producer  streams the data from these two apis into two Kafka topic on the confluence cluster at kafka://pkc-ep9mm.us-east-2.aws.confluent.cloud:9092 \"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"(1) nyc-citibike-station-status. (2) nyc-citibike-station-info\"}]},{\"type\":\"paragraph\",\"children\":[{\"text\":\"On Kinetica side, we stream data from these two topics into two tables station_status and stations-info.\"}]}]","previous_block_id":null,"next_block_id":"bd5a85f0-a010-11ec-a817-7f4608b5e3ed","block_type_id":"a9949a1a-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T16:05:21.244Z","updated_at":"2022-03-10T01:23:50.015Z","worksheetId":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"a9949a1a-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd613cb0-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Create a Kafka sink destination for topic nyc-citibike-demand-alert\"}]}]","previous_block_id":"bd5507b0-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bd568e50-a010-11ec-a817-7f4608b5e3ed","block_type_id":"a9949a1a-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T16:12:44.037Z","updated_at":"2022-03-10T01:23:50.030Z","worksheetId":"bd4c5520-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"a9949a1a-14e3-11eb-adc1-0242ac120002"}],"bd7a42f0-a010-11ec-a817-7f4608b5e3ed":[{"config":{},"id":"bd7e1380-a010-11ec-a817-7f4608b5e3ed","name":"Block 1","description":"Description for Block 1","content":"\"CREATE OR REPLACE MATERIALIZED VIEW regression_view \\nAS SELECT DECIMAL(REGR_INTERCEPT(s1.capacity - s2.num_bikes_available), s2.last_reported)) as b, DECIMAL(REGR_SLOPE(s1.capacity - s2.num_bikes_available), s2.last_reported) as a, s1.station_id\\nFROM station_capacity s1, station_status s2\\nWHERE s1.station_id = s2.station_id\\nGROUP BY station_id\\n\"","previous_block_id":"bd800f50-a010-11ec-a817-7f4608b5e3ed","next_block_id":null,"block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-19T14:54:52.969Z","updated_at":"2022-03-10T01:23:50.164Z","worksheetId":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd86c610-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Create necessary views to analyze realtime and calculate linear regression values of bikes demand at docking stations over time.\"}]}]","previous_block_id":null,"next_block_id":"f9816100-a66b-11ec-a817-7f4608b5e3ed","block_type_id":"a9949a1a-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T16:15:36.633Z","updated_at":"2022-03-18T13:15:37.390Z","worksheetId":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"a9949a1a-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd891000-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"\"","previous_block_id":"bd828050-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bd8ae4c0-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T19:48:42.175Z","updated_at":"2022-03-10T01:23:50.203Z","worksheetId":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd8ae4c0-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"\"","previous_block_id":"bd891000-a010-11ec-a817-7f4608b5e3ed","next_block_id":null,"block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T19:48:43.312Z","updated_at":"2022-03-10T01:23:50.220Z","worksheetId":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"f9816100-a66b-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"CREATE OR REPLACE MATERIALIZED VIEW ki_home.hourly_demand AS \\nSELECT station_id, dt, num_bikes_available \\nFROM ki_home.station_status \\nWHERE 18 = HOUR(dt)\\nAND DAY_OF_WEEK(dt) = 3;\\n\\n--Analyze a few stations\\nSELECT MINUTE(s2.dt) as dt, (s1.cap - s2.num_bikes_available) as demand, s2.num_bikes_available, s2.station_id \\nFROM ki_home.hourly_demand s2, station_capacity s1 \\nwhere s1.station_id = s2.station_id and s2.station_id >= 3150 and s2.station_id <= 3173;\"","previous_block_id":"bd86c610-a010-11ec-a817-7f4608b5e3ed","next_block_id":"3a5599d0-a66c-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T03:32:01.936Z","updated_at":"2022-03-29T02:35:26.039Z","worksheetId":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"3a5599d0-a66c-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"--Predicted high demand stations\\nCREATE OR REPLACE MATERIALIZED VIEW ki_home.pred_high_demand_stations \\nAS SELECT AVG(s1.cap - s2.num_bikes_available) as avg_demand, AVG(s2.num_bikes_available) avg_bike_avail, s2.station_id, MIN(s1.lat) as lat, MIN(s1.lon) as lon\\nFROM ki_home.hourly_demand s2, station_capacity s1  \\nWHERE s1.station_id = s2.station_id\\nGROUP BY s2.station_id \"","previous_block_id":"f9816100-a66b-11ec-a817-7f4608b5e3ed","next_block_id":"6c596740-a66c-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T03:33:50.702Z","updated_at":"2022-03-18T13:37:09.519Z","worksheetId":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"6c596740-a66c-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"{\"table_schema\":\"ki_home\",\"table_name\":\"pred_high_demand_stations\",\"geometry_type\":\"lon_lat\",\"longitude\":\"lon\",\"latitude\":\"lat\",\"renderType\":\"heatmap\",\"colormap\":\"jet\",\"blurRadius\":7,\"center_longitude\":-73.9852,\"center_latitude\":40.7565,\"zoom_level\":10.76,\"opacity\":70,\"overrides\":0}","previous_block_id":"3a5599d0-a66c-11ec-a817-7f4608b5e3ed","next_block_id":"c6162fd0-a675-11ec-a817-7f4608b5e3ed","block_type_id":"e8ccc4e2-793f-47ed-9af2-f0a58a840006","worksheet_id":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T03:35:14.613Z","updated_at":"2022-03-31T12:11:35.479Z","worksheetId":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"e8ccc4e2-793f-47ed-9af2-f0a58a840006"},{"config":{},"id":"c1295a60-a675-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"\"","previous_block_id":"6c596740-a66c-11ec-a817-7f4608b5e3ed","next_block_id":null,"block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T04:42:02.375Z","updated_at":"2022-03-18T04:42:02.375Z","worksheetId":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"c6162fd0-a675-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"CREATE OR REPLACE MATERIALIZED VIEW regression_view \\nAS SELECT DECIMAL(REGR_INTERCEPT((s1.cap - s2.num_bikes_available), MINUTE(s2.dt))) as b, \\n          DECIMAL(REGR_SLOPE((s1.cap - s2.num_bikes_available), MINUTE(s2.dt))) as a, \\n          s1.station_id, MAX(s1.cap) as cap, s1.lon, s1.lat, MIN(dt) as min_dt\\nFROM station_capacity s1, hourly_demand s2, data_start_info s3\\nWHERE s1.station_id = s2.station_id AND s3.station_id = s1.station_id\\nGROUP BY station_id, lon, lat\\nORDER BY station_id;\"","previous_block_id":"6c596740-a66c-11ec-a817-7f4608b5e3ed","next_block_id":null,"block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T04:42:10.637Z","updated_at":"2022-03-18T13:36:47.521Z","worksheetId":"bd7a42f0-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"}],"bd95e140-a010-11ec-a817-7f4608b5e3ed":[{"config":{},"id":"bd9767e0-a010-11ec-a817-7f4608b5e3ed","name":"Block 1","description":"Description for Block 1","content":"\"CREATE TABLE \\\"station_status\\\"\\n(\\n   \\\"eightd_active_station_services\\\" VARCHAR (64),\\n   \\\"eightd_has_available_keys\\\" TINYINT NOT NULL,\\n   \\\"is_installed\\\" TINYINT NOT NULL,\\n   \\\"is_renting\\\" TINYINT NOT NULL,\\n   \\\"is_returning\\\" TINYINT NOT NULL,\\n   \\\"last_reported\\\" INTEGER NOT NULL,\\n   \\\"legacy_id\\\" SMALLINT NOT NULL,\\n   \\\"num_bikes_available\\\" TINYINT NOT NULL,\\n   \\\"num_bikes_disabled\\\" TINYINT NOT NULL,\\n   \\\"num_docks_available\\\" TINYINT NOT NULL,\\n   \\\"num_docks_disabled\\\" TINYINT NOT NULL,\\n   \\\"num_ebikes_available\\\" TINYINT NOT NULL,\\n   \\\"station_id\\\" SMALLINT NOT NULL,\\n   \\\"station_status\\\" VARCHAR (16, dict) NOT NULL,\\n   \\\"valet\\\" VARCHAR (256),\\n   dt  DATETIME(INIT_WITH_NOW) NOT NULL\\n);\\n\\n\"","previous_block_id":"bd98ee80-a010-11ec-a817-7f4608b5e3ed","next_block_id":"88070660-b129-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd95e140-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-19T15:42:32.061Z","updated_at":"2022-03-31T19:34:07.640Z","worksheetId":"bd95e140-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd98ee80-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Create Station Status table\",\"bold\":true}]}]","previous_block_id":null,"next_block_id":"bd9767e0-a010-11ec-a817-7f4608b5e3ed","block_type_id":"a9949a1a-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd95e140-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T16:00:58.118Z","updated_at":"2022-03-10T01:23:50.265Z","worksheetId":"bd95e140-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"a9949a1a-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"88070660-b129-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"CREATE TABLE ki_home.honey1test (\\n    signal_id SMALLINT,\\n    eoc_id TINYINT,\\n    probability double\\n)\"","previous_block_id":"bd9767e0-a010-11ec-a817-7f4608b5e3ed","next_block_id":null,"block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd95e140-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-31T19:34:07.558Z","updated_at":"2022-03-31T19:36:33.326Z","worksheetId":"bd95e140-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"}],"bd9cbf10-a010-11ec-a817-7f4608b5e3ed":[{"config":{},"id":"bd9e1ea0-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"CREATE OR REPLACE MATERIALIZED VIEW streaming_station_demand\\nREFRESH EVERY 1 MINUTE\\nAS   SELECT (CONCAT ( CONCAT ('Demand exceeded at  station ', CONCAT(STATION_ID, ' at time ')),  CHAR128(time_of_demand) ) ) as  message, * , \\n            (bike_demand - num_bikes_available) as demand_gap\\nFROM \\n(\\nSELECT  ROUND((r.b + (r.a * MINUTE(s2.dt)))) as bike_demand, s2.station_id, s2.num_bikes_available, s2.dt time_of_demand, r.b, r.a,\\n        MINUTE(s2.dt) as x, r.min_dt, r.cap, r.lon, r.lat\\nFROM  station_status s2, regression_view r\\nWHERE s2.station_id = r.station_id\\n) ;\"","previous_block_id":"bda104d0-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bda26460-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","created_at":"2021-10-27T23:47:24.837Z","updated_at":"2022-03-18T14:42:33.084Z","worksheetId":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bd9f5720-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"CREATE STREAM demand_alert ON TABLE streaming_station_demand\\nWHERE bike_demand > num_bikes_available\\nWITH OPTIONS (\\n  event = 'insert' , \\n  datasink_name = 'station_alerts',\\n  increasing_column = 'time_of_demand'\\n);\"","previous_block_id":"bda41210-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bda571a0-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-01-04T16:58:25.364Z","updated_at":"2022-03-11T02:10:05.194Z","worksheetId":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bda104d0-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Create view to calculate bikes demand at docking stations over time.\",\"bold\":true}]}]","previous_block_id":null,"next_block_id":"bd9e1ea0-a010-11ec-a817-7f4608b5e3ed","block_type_id":"a9949a1a-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T16:16:39.226Z","updated_at":"2022-03-10T01:23:50.385Z","worksheetId":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"a9949a1a-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bda26460-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"[{\"type\":\"paragraph\",\"children\":[{\"text\":\"For every station where the demand exceeds the number of bikes available , send an alert event into nyc-citibike-demand-alert topic on the Kafka cluster. \",\"bold\":true}]}]","previous_block_id":"bd9e1ea0-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bda41210-a010-11ec-a817-7f4608b5e3ed","block_type_id":"a9949a1a-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T16:17:49.339Z","updated_at":"2022-03-18T05:09:10.591Z","worksheetId":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"a9949a1a-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bda41210-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"DROP STREAM  demand_alert;\"","previous_block_id":"bda26460-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bd9f5720-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T19:11:53.597Z","updated_at":"2022-03-10T01:23:50.400Z","worksheetId":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bda571a0-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"CREATE STREAM demand_alert_webhook ON TABLE streaming_station_demand\\nWHERE bike_demand > num_bikes_available\\nWITH OPTIONS (\\n  event = 'insert' , \\n  increasing_column = 'time_of_demand',\\n  DESTINATION = 'https://webhook.site/73653a8f-3094-4e79-a7d8-151d74bb1dbc'\\n);\"","previous_block_id":"bd9f5720-a010-11ec-a817-7f4608b5e3ed","next_block_id":null,"block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T19:19:00.831Z","updated_at":"2022-03-18T04:59:49.715Z","worksheetId":"bd9cbf10-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"}],"bdc4b970-a010-11ec-a817-7f4608b5e3ed":[{"config":{},"id":"bdc5f1f0-a010-11ec-a817-7f4608b5e3ed","name":"Block 1","description":"Description for Block 1","content":"\"CREATE OR REPLACE MATERIALIZED VIEW streaming_station_status_view \\nAS SELECT IFNULL((s1.cap - s2.num_bikes_available),0) as bikes_taken, \\n          s2.station_id, LONG(s2.dt) as dt_h, s1.cap, s2.dt\\nFROM station_capacity s1, station_status s2, data_start_info s3\\nWHERE s1.station_id = s2.station_id AND s3.station_id = s1.station_id\\nAND (LONG(s2.dt) - LONG(s3.mdt)) > 0\\nORDER BY station_id\"","previous_block_id":"bdc92640-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bdca5ec0-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T19:49:58.055Z","updated_at":"2022-03-10T01:23:50.589Z","worksheetId":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bdc79fa0-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"\\nSELECT * FROM TABLE\\n(\\n    PREDICT\\n    (\\n        HISTORY_TABLE => INPUT_TABLE(stations_status_history_view),\\n        X_COLUMN => 'dt_h',\\n        Y_COLUMN => 'bikes_taken',\\n        PREDICT_ON_TABLE => INPUT_TABLE(streaming_station_status_view),\\n        PREDICT_ON_COLUMN => 'dt_h'\\n    )\\n)\"","previous_block_id":"bdcb9740-a010-11ec-a817-7f4608b5e3ed","next_block_id":null,"block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T19:57:51.824Z","updated_at":"2022-03-10T01:23:50.599Z","worksheetId":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bdc92640-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"CREATE OR REPLACE MATERIALIZED VIEW stations_status_history_view\\nAS SELECT IFNULL((s1.cap - s2.num_bikes_available), 0) as bikes_taken, \\n          s2.station_id,  LONG(s2.dt) dt_h, s2.dt\\nFROM station_capacity s1, station_status s2, data_start_info s3\\nWHERE s1.station_id = s2.station_id \\n    AND s3.station_id = s1.station_id\\n    AND (LONG(s2.dt) - LONG(s3.mdt)) <= 60\\nORDER BY station_id\\n\"","previous_block_id":null,"next_block_id":"bdc5f1f0-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-07T20:18:09.574Z","updated_at":"2022-03-10T01:23:50.607Z","worksheetId":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bdca5ec0-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"DESCRIBE VIEW stations_status_history_view\"","previous_block_id":"bdc5f1f0-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bdcb9740-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-09T18:31:32.629Z","updated_at":"2022-03-10T01:23:50.615Z","worksheetId":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bdcb9740-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"DESCRIBE VIEW streaming_station_status_view\"","previous_block_id":"bdca5ec0-a010-11ec-a817-7f4608b5e3ed","next_block_id":"bdc79fa0-a010-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-09T19:18:29.362Z","updated_at":"2022-03-10T01:23:50.623Z","worksheetId":"bdc4b970-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"}],"bdd35f70-a010-11ec-a817-7f4608b5e3ed":[{"config":{},"id":"bdd4bf00-a010-11ec-a817-7f4608b5e3ed","name":"Block 1","description":"Description for Block 1","content":"\"-- CREATE OR REPLACE MATERIALIZED VIEW regression_view \\n-- AS SELECT DECIMAL(REGR_INTERCEPT((s1.cap - s2.num_bikes_available), LONG(s2.dt) - LONG(s3.start_dt))) as b, \\n--           DECIMAL(REGR_SLOPE((s1.cap - s2.num_bikes_available), LONG(s2.dt) - LONG(s3.start_dt))) as a, \\n--           s1.station_id, MAX(s1.cap) as cap, s1.lon, s1.lat\\n-- FROM station_capacity s1, station_status s2, data_start_info s3\\n-- WHERE s1.station_id = s2.station_id AND s3.station_id = s1.station_id\\n-- GROUP BY station_id, lon, lat\\n-- ORDER BY station_id\\n\\n-- SELECT ROUND(AVG(num_bikes_available), 2) avg_b_avail, ROUND(AVG(num_bikes_disabled), 2) avg_bike_disabled, ROUND(AVG(num_docks_available),2) avg__d_avail, ROUND(AVG(num_docks_disabled), 2) avg_d_disabled, HOUR(dt) as d_hour from ki_home.station_status s1, ki_home.station_info s2 WHERE legacy_id = 528 OR legacy_id = 528 GROUP BY HOUR(dt) ORDER BY HOUR(dt))\\n\\n-- select count(*), HOUR(st.dt)*60+MINUTE(st.dt), AVG(st.num_bikes_available) \\n-- from station_status st \\n-- where st.legacy_id = 247 group by HOUR(st.dt)*60+(MINUTE(st.dt)) order by HOUR(st.dt)*60+MINUTE(st.dt);\\n\\n\\n-- select CURRENT_DATETIME(), HOUR(CURRENT_DATETIME()) * 60+ MINUTE(dt), HOUR(dt) from ki_home.station_status where \\n-- HOUR(CURRENT_DATETIME())*60  > HOUR(dt)*60 + MINUTE(dt) and HOUR(CURRENT_DATETIME())*60+30 < HOUR(dt)*60 + MINUTE(dt)\\n-- limit 10\\n\\n-- select HOUR(DATEADD('HOUR', -1, CURRENT_DATETIME()))*60 as hour_ago, HOUR(CURRENT_DATETIME())*60 as curr_hour, HOUR(dt) * 60+ MINUTE(dt) as time_tot, dt from ki_home.station_status\\n-- where HOUR(DATEADD('HOUR', -1, CURRENT_DATETIME()))*60  = HOUR(dt)*60 order by dt desc\\n-- limit 10\\n\\n-- CREATE OR REPLACE MATERIALIZED VIEW ki_home.avail_hour_ago AS SELECT station_id, MAX(dt) as max_dt, AVG(num_bikes_available) as num_bikes_available  FROM ki_home.station_status WHERE HOUR(DATEADD('HOUR', -1, CURRENT_DATETIME()))  = HOUR(dt) GROUP BY HOUR(dt), station_id ORDER BY station_id;\\n-- CREATE OR REPLACE MATERIALIZED VIEW ki_home.avail_now AS SELECT station_id, MAX(dt) as max_dt, AVG(num_bikes_available) as num_bikes_available  FROM ki_home.station_status WHERE HOUR(DATEADD('HOUR', 0, CURRENT_DATETIME()))  = HOUR(dt) GROUP BY HOUR(dt), station_id ORDER BY station_id;\\n\\n-- CREATE OR REPLACE MATERIALIZED VIEW regression_view4 \\n-- AS SELECT DECIMAL(REGR_INTERCEPT(((si.cap - s1.num_bikes_available) - (si.cap - s2.num_bikes_available)), TIMESTAMPDIFF(HOUR, s1.max_dt, s2.max_dt))) as b, \\n--           DECIMAL(REGR_SLOPE(((si.cap - s1.num_bikes_available) - (si.cap - s2.num_bikes_available)), TIMESTAMPDIFF(HOUR, s1.max_dt, s2.max_dt))) as a, \\n--           s1.station_id, si.lon, si.lat, MAX(s1.max_dt), MAX(s2.max_dt)\\n-- FROM avail_hour_ago s1, avail_now s2, ki_home.station_capacity si\\n-- WHERE s1.station_id = s2.station_id AND s1.station_id = si.station_id\\n-- GROUP BY station_id, lon, lat\\n-- ORDER BY station_id\\n\\n-- CREATE OR REPLACE MATERIALIZED VIEW ki_home.avail_hour_ago AS SELECT station_id, dt, num_bikes_available  FROM ki_home.station_status WHERE HOUR(DATEADD('HOUR', -8, CURRENT_DATETIME()))  = HOUR(dt) ORDER BY station_id;\\n-- CREATE OR REPLACE MATERIALIZED VIEW ki_home.avail_now AS SELECT station_id, dt, num_bikes_available  FROM ki_home.station_status WHERE HOUR(DATEADD('HOUR', -7, CURRENT_DATETIME()))  = HOUR(dt) ORDER BY station_id;\\n\\n\\n\\n-- CREATE OR REPLACE MATERIALIZED VIEW regression_view4 \\n-- AS SELECT DECIMAL(REGR_INTERCEPT(((si.cap - s1.num_bikes_available) - (si.cap - s2.num_bikes_available)), TIMESTAMPDIFF(HOUR, s1.max_dt, s2.max_dt))) as b, \\n--           DECIMAL(REGR_SLOPE(((si.cap - s1.num_bikes_available) - (si.cap - s2.num_bikes_available)), TIMESTAMPDIFF(HOUR, s1.max_dt, s2.max_dt))) as a, \\n--           s1.station_id, si.lon, si.lat, MAX(s1.max_dt), MAX(s2.max_dt)\\n-- FROM avail_hour_ago s1, avail_now s2, ki_home.station_capacity si\\n-- WHERE s1.station_id = s2.station_id AND s1.station_id = si.station_id\\n-- GROUP BY station_id, lon, lat\\n-- ORDER BY station_id\\n\\n\\n-- CREATE OR REPLACE MATERIALIZED VIEW ki_home.avail_start AS \\n-- SELECT num_bikes_available, dt, station_id, FIRST_VALUE(num_bikes_available) OVER \\n-- (PARTITION BY station_id   \\n--                                    ORDER BY dt ASC)  \\n-- AS first_val \\n-- FROM  ki_home.avail_hour_ago order by dt;\\n\\n\\n\\n-- SELECT MINUTE(s2.dt) as dt, (s1.cap - s2.num_bikes_available) as demand, s2.num_bikes_available, s2.station_id \\n-- FROM ki_home.avail_hour_ago s2, station_capacity s1 \\n-- where s1.station_id = s2.station_id and s2.station_id >= 3150 and s2.station_id <= 3173;\\n\\n\\n\\n\\n-- CREATE OR REPLACE MATERIALIZED VIEW ki_home.pred_high_demand_stations \\n-- AS SELECT AVG(s1.cap - s2.num_bikes_available) as avg_demand, AVG(s2.num_bikes_available), s2.station_id, MIN(s1.lat) as lat, MIN(s1.lon) as lon\\n-- FROM ki_home.avail_hour_ago s2, station_capacity s1  \\n-- WHERE s1.station_id = s2.station_id\\n-- GROUP BY s2.station_id \\n\\n-- use query above for map\\n\"","previous_block_id":"bdd6bad0-a010-11ec-a817-7f4608b5e3ed","next_block_id":"580cc660-a248-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-09T21:02:24.272Z","updated_at":"2022-03-18T02:07:24.804Z","worksheetId":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"bdd6bad0-a010-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"[{\"type\":\"paragraph\",\"children\":[{\"text\":\"Test Visualization\"}]}]","previous_block_id":null,"next_block_id":"bdd4bf00-a010-11ec-a817-7f4608b5e3ed","block_type_id":"a9949a1a-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-09T21:02:36.025Z","updated_at":"2022-03-10T01:23:50.676Z","worksheetId":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"a9949a1a-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"580cc660-a248-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"-- CREATE OR REPLACE MATERIALIZED VIEW streaming_station_demand\\n-- REFRESH EVERY 1 MINUTE\\n-- AS   SELECT (CONCAT ( CONCAT ('Demand exceeded at  station ', CONCAT(STATION_ID, ' at time ')),  CHAR128(time_of_demand) ) ) as  message, * , \\n--             (bike_demand - num_bikes_available) as demand_gap\\n-- FROM \\n-- (\\n-- SELECT  ROUND((r.b + (r.a * DECIMAL(LONG(s2.dt) - LONG(r.min_dt))))) as bike_demand, s2.station_id, s2.num_bikes_available, s2.dt time_of_demand, r.b, r.a,\\n--         LONG(s2.dt) - LONG(r.min_dt) as x, r.min_dt, r.cap, r.lon, r.lat\\n-- FROM  station_status s2, regression_view r, data_start_info s3 \\n-- WHERE s2.station_id = r.station_id AND  s3.station_id = r.station_id\\n-- ) ;\\n\\n\\n\\nCREATE OR REPLACE MATERIALIZED VIEW streaming_station_demand\\nREFRESH EVERY 1 MINUTE\\nAS   SELECT (CONCAT ( CONCAT ('Demand exceeded at  station ', CONCAT(STATION_ID, ' at time ')),  CHAR128(time_of_demand) ) ) as  message, * , \\n            (bike_demand - num_bikes_available) as demand_gap\\nFROM \\n(\\nSELECT  ROUND((r.b + (r.a * MINUTE(s2.dt)))) as bike_demand, s2.station_id, s2.num_bikes_available, s2.dt time_of_demand, r.b, r.a,\\n        MINUTE(s2.dt) as x, r.min_dt, r.cap, r.lon, r.lat\\nFROM  station_status s2, regression_view r, data_start_info s3 \\nWHERE s2.station_id = r.station_id AND  s3.station_id = r.station_id\\n) ;\"","previous_block_id":"bdd4bf00-a010-11ec-a817-7f4608b5e3ed","next_block_id":"7e9ea8b0-a659-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-12T21:06:54.023Z","updated_at":"2022-03-18T03:20:47.251Z","worksheetId":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"7e9ea8b0-a659-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"-- CREATE OR REPLACE MATERIALIZED VIEW ki_home.avail_now AS SELECT station_id, dt, num_bikes_available  FROM ki_home.station_status WHERE HOUR(DATEADD('HOUR', -7, CURRENT_DATETIME()))  = HOUR(dt) ORDER BY station_id;\\n\\nCREATE OR REPLACE MATERIALIZED VIEW ki_home.avail_hour_ago AS \\nSELECT station_id, dt, num_bikes_available \\nFROM ki_home.station_status \\nWHERE HOUR(DATEADD('HOUR', -5, CURRENT_DATETIME()))  = HOUR(dt) \\nAND DAY_OF_WEEK(dt) = 1 ORDER BY station_id;\\n\"","previous_block_id":"580cc660-a248-11ec-a817-7f4608b5e3ed","next_block_id":"3690f5e0-a65a-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T01:19:44.827Z","updated_at":"2022-03-18T02:07:36.692Z","worksheetId":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"3690f5e0-a65a-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"-- CREATE OR REPLACE MATERIALIZED VIEW regression_view \\n-- AS SELECT DECIMAL(REGR_INTERCEPT((s1.cap - s2.num_bikes_available), MINUTE(s2.dt))) as b, \\n--           DECIMAL(REGR_SLOPE((s1.cap - s2.num_bikes_available), MINUTE(s2.dt))) as a, \\n--           s1.station_id, MAX(s1.cap) as cap, s1.lon, s1.lat, MIN(dt) as min_dt\\n-- FROM station_capacity s1, avail_hour_ago s2, data_start_info s3\\n-- WHERE s1.station_id = s2.station_id AND s3.station_id = s1.station_id\\n-- GROUP BY station_id, lon, lat\\n-- ORDER BY station_id\"","previous_block_id":"7e9ea8b0-a659-11ec-a817-7f4608b5e3ed","next_block_id":"370fc2d0-a65a-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T01:24:53.439Z","updated_at":"2022-03-18T03:13:54.730Z","worksheetId":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"370fc2d0-a65a-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"CREATE OR REPLACE MATERIALIZED VIEW ki_home.avail_hour_ago AS \\nSELECT station_id, dt, num_bikes_available \\nFROM ki_home.station_status \\nWHERE HOUR(DATEADD('HOUR', -1, CURRENT_DATETIME()))  = HOUR(dt)\\nAND DAY_OF_WEEK(dt) > 4 AND DAY_OF_WEEK(dt) < 6 ORDER BY station_id;\\n\\nCREATE OR REPLACE MATERIALIZED VIEW regression_view \\nAS SELECT DECIMAL(REGR_INTERCEPT((s1.cap - s2.num_bikes_available), MINUTE(s2.dt))) as b, \\n          DECIMAL(REGR_SLOPE((s1.cap - s2.num_bikes_available), MINUTE(s2.dt))) as a, \\n          s1.station_id, MAX(s1.cap) as cap, s1.lon, s1.lat, MIN(dt) as min_dt\\nFROM station_capacity s1, avail_hour_ago s2, data_start_info s3\\nWHERE s1.station_id = s2.station_id AND s3.station_id = s1.station_id\\nGROUP BY station_id, lon, lat\\nORDER BY station_id;\\n\\n--create chart\\nSELECT MINUTE(s2.dt) as dt, (s1.cap - s2.num_bikes_available) as demand, s2.num_bikes_available, s2.station_id \\nFROM ki_home.avail_hour_ago s2, station_capacity s1 \\nwhere s1.station_id = s2.station_id and s2.station_id >= 3150 and s2.station_id <= 3173;\\n\"","previous_block_id":"3690f5e0-a65a-11ec-a817-7f4608b5e3ed","next_block_id":"3793e6f0-a65a-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T01:24:54.269Z","updated_at":"2022-03-18T03:14:08.306Z","worksheetId":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"3793e6f0-a65a-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"--predicted high demand stations\\nCREATE OR REPLACE MATERIALIZED VIEW ki_home.pred_high_demand_stations \\nAS SELECT AVG(s1.cap - s2.num_bikes_available) as avg_demand, AVG(s2.num_bikes_available) avg_bike_avail, s2.station_id, MIN(s1.lat) as lat, MIN(s1.lon) as lon\\nFROM ki_home.avail_hour_ago s2, station_capacity s1  \\nWHERE s1.station_id = s2.station_id\\nGROUP BY s2.station_id \"","previous_block_id":"370fc2d0-a65a-11ec-a817-7f4608b5e3ed","next_block_id":"9bd57630-a65d-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T01:24:55.135Z","updated_at":"2022-03-18T01:57:49.920Z","worksheetId":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"9bd57630-a65d-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"{\"table_schema\":\"ki_home\",\"table_name\":\"pred_high_demand_stations\",\"geometry_type\":\"lon_lat\",\"longitude\":\"lon\",\"latitude\":\"lat\",\"renderType\":\"cb_raster\",\"cbAttr\":\"avg_demand\",\"cb_type\":\"equal_interval\",\"cb_num_classes\":5,\"cb_min_value\":-30,\"cb_max_value\":73,\"cb_colormap\":\"jet\",\"pointSize\":5,\"center_longitude\":-73.9852,\"center_latitude\":40.7565,\"zoom_level\":10.76,\"opacity\":70,\"overrides\":0,\"cbVals\":[-30,-9,12,33,54,73]}","previous_block_id":"3793e6f0-a65a-11ec-a817-7f4608b5e3ed","next_block_id":"a54246c0-a663-11ec-a817-7f4608b5e3ed","block_type_id":"e8ccc4e2-793f-47ed-9af2-f0a58a840006","worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T01:49:11.828Z","updated_at":"2022-03-18T02:32:24.935Z","worksheetId":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"e8ccc4e2-793f-47ed-9af2-f0a58a840006"},{"config":{},"id":"a54246c0-a663-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"SELECT * from ki_home.streaming_station_demand ORDER BY time_of_demand desc limit 10\"","previous_block_id":"9bd57630-a65d-11ec-a817-7f4608b5e3ed","next_block_id":"5c311790-a66d-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T02:32:24.624Z","updated_at":"2022-03-18T03:41:57.112Z","worksheetId":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"5c311790-a66d-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"-- SHOW STREAM demand_alert\\n\\nSHOW DATA SINK station_alerts\"","previous_block_id":"a54246c0-a663-11ec-a817-7f4608b5e3ed","next_block_id":"2825a430-a676-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T03:41:57.003Z","updated_at":"2022-03-18T04:44:55.242Z","worksheetId":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"2825a430-a676-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"--actual regression view \\nCREATE OR REPLACE MATERIALIZED VIEW streaming_station_demand\\nREFRESH EVERY 1 MINUTE\\nAS   SELECT (CONCAT ( CONCAT ('Demand exceeded at  station ', CONCAT(STATION_ID, ' at time ')),  CHAR128(time_of_demand) ) ) as  message, * , \\n            (bike_demand - num_bikes_available) as demand_gap\\nFROM \\n(\\nSELECT  ROUND((r.b + (r.a * DECIMAL(LONG(s2.dt) - LONG(s3.start_dt))))) as bike_demand, s2.station_id, s2.num_bikes_available, s2.dt time_of_demand, r.b, r.a,\\n        LONG(s2.dt) - LONG(s3.start_dt) as x, s3.start_dt, r.cap, r.lon, r.lat\\nFROM  station_status s2, regression_view r, data_start_info s3 \\nWHERE s2.station_id = r.station_id AND  s3.station_id = r.station_id\\n) ;\"","previous_block_id":"5c311790-a66d-11ec-a817-7f4608b5e3ed","next_block_id":"2b1add70-a678-11ec-a817-7f4608b5e3ed","block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T04:44:55.156Z","updated_at":"2022-03-18T04:59:19.237Z","worksheetId":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"},{"config":{},"id":"2b1add70-a678-11ec-a817-7f4608b5e3ed","name":"Block","description":"Description for Block","content":"\"DIPTI:\\n\\nCREATE OR REPLACE MATERIALIZED VIEW ki_home.recent_station_demand_view\\nREFRESH EVERY 25 SECONDS\\nAS\\nSELECT * from streaming_station_demand \\nWHERE TIMESTAMPDIFF(MINUTE, time_of_demand, NOW() ) <= 1 AND (demand_gap > 0)\\n\\n\\n\\nSELECT * FROM recent_station_demand_view\\nWHERE demand_gap > 10\\nORDER BY demand_gap DESC\\nLIMIT 100\\n\\n\\nselect count(*) \\n FROM  station_status s2, regression_view r, data_start_info s3 \\nWHERE s2.station_id = r.station_id AND  s3.station_id = r.station_id\\n\\n\\n\\nCREATE OR REPLACE MATERIALIZED VIEW station_capacity AS\\nselect station_id, lon, lat, MAX(capacity) cap\\nfrom station_info\\nGROUP BY station_id, lon, lat\\nORDER BY station_id\\n\\n\\nCREATE OR REPLACE MATERIAlIZED VIEW data_start_info\\nAS \\nSELECT station_id, MIN(dt) start_dt, MAX(dt) mdt\\nFROM station_status \\nGROUP BY station_id\\n\"","previous_block_id":"2825a430-a676-11ec-a817-7f4608b5e3ed","next_block_id":null,"block_type_id":"84b9233c-14e3-11eb-adc1-0242ac120002","worksheet_id":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","created_at":"2022-03-18T04:59:19.115Z","updated_at":"2022-03-18T13:03:54.837Z","worksheetId":"bdd35f70-a010-11ec-a817-7f4608b5e3ed","blockTypeId":"84b9233c-14e3-11eb-adc1-0242ac120002"}]},"vizMap":{"bd4ddbc0-a010-11ec-a817-7f4608b5e3ed":[],"bd4f8970-a010-11ec-a817-7f4608b5e3ed":[],"bd524890-a010-11ec-a817-7f4608b5e3ed":[],"bd53a820-a010-11ec-a817-7f4608b5e3ed":[],"bd5507b0-a010-11ec-a817-7f4608b5e3ed":[],"bd568e50-a010-11ec-a817-7f4608b5e3ed":[],"bd586310-a010-11ec-a817-7f4608b5e3ed":[],"bd5a85f0-a010-11ec-a817-7f4608b5e3ed":[],"bd5c33a0-a010-11ec-a817-7f4608b5e3ed":[],"bd5d9330-a010-11ec-a817-7f4608b5e3ed":[],"bd5f19d0-a010-11ec-a817-7f4608b5e3ed":[],"bd613cb0-a010-11ec-a817-7f4608b5e3ed":[],"bd7e1380-a010-11ec-a817-7f4608b5e3ed":[],"bd86c610-a010-11ec-a817-7f4608b5e3ed":[],"bd891000-a010-11ec-a817-7f4608b5e3ed":[],"bd8ae4c0-a010-11ec-a817-7f4608b5e3ed":[],"f9816100-a66b-11ec-a817-7f4608b5e3ed":[{"config":{"x_axis_column":"dt","y_axis_column":"demand","series_column":"station_id","x_axis_label":"dt","y_axis_label":"demand","color_scheme":"spectral"},"id":"ceffb410-a6d2-11ec-a817-7f4608b5e3ed","name":"Line Chart Visualization","description":"Description for line chart visualization","block_id":"f9816100-a66b-11ec-a817-7f4608b5e3ed","visualization_type_id":"b565ab86-0964-4e75-aed9-a11ba79fae43","created_at":"2022-03-18T15:48:08.786Z","updated_at":"2022-03-18T15:48:25.798Z","blockId":"f9816100-a66b-11ec-a817-7f4608b5e3ed","visualizationTypeId":"b565ab86-0964-4e75-aed9-a11ba79fae43"}],"3a5599d0-a66c-11ec-a817-7f4608b5e3ed":[],"6c596740-a66c-11ec-a817-7f4608b5e3ed":[],"c1295a60-a675-11ec-a817-7f4608b5e3ed":[],"c6162fd0-a675-11ec-a817-7f4608b5e3ed":[],"bd9767e0-a010-11ec-a817-7f4608b5e3ed":[],"bd98ee80-a010-11ec-a817-7f4608b5e3ed":[],"88070660-b129-11ec-a817-7f4608b5e3ed":[],"bd9e1ea0-a010-11ec-a817-7f4608b5e3ed":[],"bd9f5720-a010-11ec-a817-7f4608b5e3ed":[],"bda104d0-a010-11ec-a817-7f4608b5e3ed":[],"bda26460-a010-11ec-a817-7f4608b5e3ed":[],"bda41210-a010-11ec-a817-7f4608b5e3ed":[],"bda571a0-a010-11ec-a817-7f4608b5e3ed":[],"bdc5f1f0-a010-11ec-a817-7f4608b5e3ed":[],"bdc79fa0-a010-11ec-a817-7f4608b5e3ed":[],"bdc92640-a010-11ec-a817-7f4608b5e3ed":[],"bdca5ec0-a010-11ec-a817-7f4608b5e3ed":[],"bdcb9740-a010-11ec-a817-7f4608b5e3ed":[],"bdd4bf00-a010-11ec-a817-7f4608b5e3ed":[],"bdd6bad0-a010-11ec-a817-7f4608b5e3ed":[],"580cc660-a248-11ec-a817-7f4608b5e3ed":[],"7e9ea8b0-a659-11ec-a817-7f4608b5e3ed":[],"3690f5e0-a65a-11ec-a817-7f4608b5e3ed":[],"370fc2d0-a65a-11ec-a817-7f4608b5e3ed":[{"config":{"x_axis_column":"dt","y_axis_column":"num_bikes_available","series_column":"station_id","x_axis_label":"dt","y_axis_label":"num_bikes_available","color_scheme":"spectral"},"id":"b9d0f770-a65a-11ec-a817-7f4608b5e3ed","name":"Line Chart Visualization","description":"Description for line chart visualization","block_id":"370fc2d0-a65a-11ec-a817-7f4608b5e3ed","visualization_type_id":"b565ab86-0964-4e75-aed9-a11ba79fae43","created_at":"2022-03-18T01:28:33.640Z","updated_at":"2022-03-18T01:28:53.819Z","blockId":"370fc2d0-a65a-11ec-a817-7f4608b5e3ed","visualizationTypeId":"b565ab86-0964-4e75-aed9-a11ba79fae43"}],"3793e6f0-a65a-11ec-a817-7f4608b5e3ed":[],"9bd57630-a65d-11ec-a817-7f4608b5e3ed":[],"a54246c0-a663-11ec-a817-7f4608b5e3ed":[{"config":{"x_axis_column":"time_of_demand","y_axis_column":"bike_demand","series_column":"station_id","x_axis_label":"num_bikes_available","y_axis_label":"bike_demand","color_scheme":"spectral"},"id":"c72ab240-a663-11ec-a817-7f4608b5e3ed","name":"Line Chart Visualization","description":"Description for line chart visualization","block_id":"a54246c0-a663-11ec-a817-7f4608b5e3ed","visualization_type_id":"b565ab86-0964-4e75-aed9-a11ba79fae43","created_at":"2022-03-18T02:33:21.509Z","updated_at":"2022-03-18T02:33:42.236Z","blockId":"a54246c0-a663-11ec-a817-7f4608b5e3ed","visualizationTypeId":"b565ab86-0964-4e75-aed9-a11ba79fae43"}],"5c311790-a66d-11ec-a817-7f4608b5e3ed":[],"2825a430-a676-11ec-a817-7f4608b5e3ed":[],"2b1add70-a678-11ec-a817-7f4608b5e3ed":[]}}